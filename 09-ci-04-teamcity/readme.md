# Домашнее задание к занятию "09.04 Teamcity"

## Подготовка к выполнению

1. _Поднимите инфраструктуру [teamcity](./teamcity/docker-compose.yml)_

При использовании указанной инфраструктуры система не функционировала, поэтому мной была использована инфраструктура, показанная в лекции:

```dockerfile
version: "3"
services:
  teamcity-agent:
    image: jetbrains/teamcity-agent 
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /opt/buildagent/work:/opt/buildagent/work
    environment:
      SERVER_URL: "http://84.201.174.143:8111"
```

Только с такой инфраструктурой агент появлялся в консоли TeamCity.

2. _Если хочется, можете создать свою собственную инфраструктуру на основе той технологии, которая нравится. Инструкция по установке из [документации](https://www.jetbrains.com/help/teamcity/installing-and-configuring-the-teamcity-server.html)_

Развернём 2 ВМ (`jetbrains/teamcity-server`, `jetbrains/teamcity-agent`) в Yandex Cloud:

![1](images/1.png)

3. _Дождитесь запуска teamcity, выполните первоначальную настройку_

![2](images/2.png)

4. _Авторизуйте агент_

![3](images/3.png)

5. _Сделайте fork [репозитория](https://github.com/aragastmatb/example-teamcity)_

## Основная часть

1. Создайте новый проект в teamcity на основе fork
2. Сделайте autodetect конфигурации
3. Сохраните необходимые шаги, запустите первую сборку master'a
4. Поменяйте условия сборки: если сборка по ветке `master`, то должен происходит `mvn clean package`, иначе `mvn clean test`
5. Мигрируйте `build configuration` в репозиторий
6. Создайте отдельную ветку `feature/add_reply` в репозитории
7. Напишите новый метод для класса Welcomer: метод должен возвращать произвольную реплику, содержащую слово `hunter`
8. Дополните тест для нового метода на поиск слова `hunter` в новой реплике
9. Сделайте push всех изменений в новую ветку в репозиторий
10. Убедитесь что сборка самостоятельно запустилась, тесты прошли успешно
11. Внесите изменения из произвольной ветки `feature/add_reply` в `master` через `Merge`
12. Убедитесь, что нет собранного артефакта в сборке по ветке `master`
13. Настройте конфигурацию так, чтобы она собирала `.jar` в артефакты сборки
14. Проведите повторную сборку мастера, убедитесь, что сбора прошла успешно и артефакты собраны
15. Проверьте, что конфигурация в репозитории содержит все настройки конфигурации из teamcity
16. В ответ предоставьте ссылку на репозиторий